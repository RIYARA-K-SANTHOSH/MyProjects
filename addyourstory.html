{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Connect Matrimony - Kerala's Most Trusted Matrimonial Service</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        /* Updated Upload Section Styles */
.upload-section {
    border: 2px dashed #ddd;
    border-radius: 8px;
    padding: 30px;
    text-align: center;
    margin-bottom: 20px;
    transition: all 0.3s;
    position: relative;
    min-height: 200px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.upload-section.has-preview {
    padding: 10px;
    justify-content: flex-start;
}

.upload-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: all 0.3s;
}

.upload-section.has-preview .upload-content {
    display: none;
}

.upload-preview {
    display: none;
    width: 100%;
    height: 100%;
    position: relative;
}

.upload-section.has-preview .upload-preview {
    display: block;
}

.upload-preview-image {
    max-width: 100%;
    max-height: 180px;
    border-radius: 5px;
    object-fit: contain;
}

.upload-change-btn {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background: rgba(0,0,0,0.7);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 5px 10px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.3s;
}

.upload-change-btn:hover {
    background: #d82a4e;
}
        /* Header Styles */
        .header {
            background-color: black;
            padding: 15px 0;
            position: fixed;
            width: 100%;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .header.scrolled {
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(5px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 30px;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo img {
            height: 40px;
        }
        
        .logo-text {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            color: white;
            margin-left: 10px;
            font-weight: 600;
        }
        
        .main-nav ul {
            display: flex;
            list-style: none;
        }
        
        .main-nav li {
            margin-left: 25px;
            position: relative;
        }
        
        .main-nav a {
            text-decoration: none;
            color: rgb(150, 127, 129);
            font-weight: 300;
            font-size: 20px;
            transition: color 0.3s;
            display: flex;
            align-items: center;
        }
        
        .main-nav a i {
            margin-right: 5px;
            font-size: 14px;
        }
        
        .main-nav a:hover {
            color: #333;
        }
        
        /* Dropdown Styles - Updated for click functionality */
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            min-width: 200px;
            box-shadow: 0 8px 16px rgb(250, 249, 249);
            border-radius: 5px;
            padding: 10px 0;
            z-index: 1000;
            display: none;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            pointer-events: none;
        }
        
        .dropdown.active .dropdown-menu {
            display: block;
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }
        
        .dropdown-menu li {
            margin: 0;
            padding: 0;
        }
        
        .dropdown-menu a {
            color: #333 !important;
            padding: 10px 20px;
            font-size: 16px;
            display: block;
            transition: all 0.3s;
        }
        
        .dropdown-menu a:hover {
            background-color: #f5f5f5;
            color: #d82a4e !important;
        }
        
        .dropdown > a::after {
            content: '\f078';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            margin-left: 5px;
            font-size: 12px;
            transition: transform 0.3s;
        }
        
        .dropdown.active > a::after {
            transform: rotate(180deg);
        }
        
        .login-register {
            display: flex;
            align-items: center;
            margin-left: 20px;
        }
        
        .login-btn, .register-btn {
            padding: 8px 18px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            margin-left: 10px;
            transition: all 0.3s ease;
        }
        
        .login-btn {
            color: white;
            border: 1px solid white;
        }
        
        .login-btn:hover {
            background-color: rgba(255,255,255,0.1);
        }
        
        .register-btn {
            background-color: #d82a4e;
            color: white;
            box-shadow: 0 4px 8px rgba(216, 42, 78, 0.3);
        }
        
        .register-btn:hover {
            background-color: #c21e40;
            transform: translateY(-2px);
        }
        
        /* Search Bar in Header */
        .search-container {
            position: relative;
            margin-left: 20px;
        }
        
        .search-input {
            width: 40px;
            height: 40px;
            padding: 5px 15px 5px 40px;
            border: none;
            border-radius: 20px;
            outline: none;
            background-color: rgba(255,255,255,0.2);
            color: white;
            font-size: 14px;
            transition: all 0.5s ease;
            cursor: pointer;
        }
        
        .search-input::placeholder {
            color: transparent;
        }
        
        .search-input:focus {
            width: 200px;
            background-color: rgba(255,255,255,0.9);
            color: #333;
            cursor: text;
        }
        
        .search-input:focus::placeholder {
            color: #999;
        }
        
        .search-icon {
            position: absolute;
            top: 10px;
            left: 15px;
            color: white;
            pointer-events: none;
        }
        
        .search-input:focus + .search-icon {
            color: #d82a4e;
        }
        .success-story-section {
            padding: 100px 0 60px;
            background-color: #f9f9f9;
        }

        .form-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 30px rgba(0,0,0,0.1);
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        .form-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .form-header h1 {
            font-family: 'Playfair Display', serif;
            color: #d82a4e;
            font-size: 36px;
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
        }

        .form-header h1:after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: #d82a4e;
        }

        .form-header p {
            color: #666;
            font-size: 16px;
            max-width: 600px;
            margin: 0 auto;
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -15px 25px;
        }

        .form-group {
            flex: 1 0 calc(50% - 30px);
            margin: 0 15px 20px;
            min-width: 250px;
        }

        .form-group.full-width {
            flex: 1 0 calc(100% - 30px);
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #444;
            font-size: 15px;
        }

        .form-label.required:after {
            content: '*';
            color: #d82a4e;
            margin-left: 4px;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 15px;
            transition: all 0.3s;
        }

        .form-input:focus {
            border-color: #d82a4e;
            box-shadow: 0 0 0 3px rgba(216, 42, 78, 0.1);
            outline: none;
        }

        .phone-input-container {
            display: flex;
            align-items: center;
        }

        .country-code {
            flex: 0 0 80px;
            margin-right: 10px;
        }

        .phone-number {
            flex: 1;
        }

        /* File Upload Styles */
        .upload-section {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s;
            position: relative;
        }

        .upload-section:hover {
            border-color: #d82a4e;
        }

        .upload-section.active {
            border-color: #d82a4e;
            background-color: rgba(216, 42, 78, 0.05);
        }

        .upload-icon {
            font-size: 48px;
            color: #d82a4e;
            margin-bottom: 15px;
        }

        .upload-text {
            margin-bottom: 15px;
        }

        .upload-text h4 {
            color: #333;
            margin-bottom: 5px;
            font-size: 18px;
        }

        .upload-text p {
            color: #777;
            font-size: 14px;
        }

        .browse-btn {
            display: inline-block;
            padding: 8px 20px;
            background: #d82a4e;
            color:white ;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            font-size: 14px;
        }

        .browse-btn:hover {
            background: #c21e40;
        }

        .file-input {
            display: none;
        }

        .preview-container {
            display: flex;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .preview-item {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 15px 15px 0;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .preview-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 25px;
            height: 25px;
            background: rgba(0,0,0,0.6);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .remove-btn:hover {
            background: #d82a4e;
        }

        /* Story Textarea */
        .story-textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 15px;
            line-height: 1.6;
            resize: vertical;
            transition: all 0.3s;
        }

        .story-textarea:focus {
            border-color: #d82a4e;
            box-shadow: 0 0 0 3px rgba(216, 42, 78, 0.1);
            outline: none;
        }

        /* Submit Button */
        .submit-btn {
            display: block;
            width: 100%;
            max-width: 300px;
            margin: 30px auto 0;
            padding: 14px;
            background: #d82a4e;
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(216, 42, 78, 0.3);
        }

        .submit-btn:hover {
            background: #c21e40;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(216, 42, 78, 0.4);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .form-group {
                flex: 1 0 100%;
            }
            
            .form-container {
                padding: 30px 20px;
            }
            
            .form-header h1 {
                font-size: 28px;
            }
        }
        /* Footer */
        .footer {
            background-color: #222;
            color: white;
            padding: 50px 0 20px;
        }
        
        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            padding: 0 20px;
        }
        
        .footer-column {
            width: 23%;
            margin-bottom: 25px;
        }
        
        .footer-title {
            font-size: 17px;
            margin-bottom: 15px;
            color: #d82a4e;
            font-weight: 600;
            position: relative;
            padding-bottom: 8px;
        }
        
        .footer-title:after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 35px;
            height: 2px;
            background-color: #d82a4e;
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: #bbb;
            text-decoration: none;
            font-size: 13px;
            transition: all 0.3s;
        }
        
        .footer-links a:hover {
            color: white;
        }
        
        .social-links {
            display: flex;
            margin-top: 15px;
        }
        
        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background-color: #333;
            color: white;
            margin-right: 8px;
            transition: all 0.3s;
        }
        
        .social-links a:hover {
            background-color: #d82a4e;
        }
        
        .copyright {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid #444;
            margin-top: 25px;
            font-size: 12px;
            color: #999;
        }
        
        /* Responsive Adjustments */
        @media (max-width: 992px) {
            .hero-title {
                font-size: 36px;
            }
            
            .hero-subtitle {
                font-size: 16px;
            }
            
            .feature-box {
                width: 48%;
            margin-bottom: 25px;
            }
            
            .footer-column {
                width: 48%;
            }
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .logo {
                margin-bottom: 15px;
                width: 100%;
                justify-content: center;
            }
            /* Back Button Styles */
    .back-button-container {
        margin-right: 15px;
    }
    
    .back-button {
        display: inline-flex;
        align-items: center;
        padding: 8px 15px;
        background-color: #f5f5f5;
        color: #333;
        border-radius: 4px;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        border: 1px solid #ddd;
    }
    
    .back-button:hover {
        background-color: #e9e9e9;
        color: #000;
        transform: translateX(-2px);
    }
    
    .back-button i {
        margin-right: 5px;
        font-size: 14px;
    }

    </style>
</head>
<body>
    <!-- Header Section -->
    <header class="header">
        <div class="header-container">
            <div class="back-button-container">
                <a href="{% url 'home' %}" class="register-btn">
                    <i class="fas fa-arrow-left"></i> Back
                </a>
            </div>
            <div class="logo">
                <span class="logo-text">Connect</span>
            </div>
            
            <nav class="main-nav">
                <ul>
                    <li class="dropdown">
                        <a href="#"><i class="fas fa-glass-cheers"></i> Success Stories</a>
                        <ul class="dropdown-menu">
                            <li><a href="{% url 'addyourstory_view' %}"><i class="fas fa-plus-circle"></i> Add Your Story</a></li>
                            <li><a href="{% url 'blessed_couples' %}"><i class="fas fa-heart"></i> Blessed Couples</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#"><i class="fas fa-question-circle"></i> Help</a>
                        <ul class="dropdown-menu">
                            <li><a href="{% url 'about_contact' %}"><i class="fas fa-envelope"></i> Contact Us</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
            
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search by ID">
                <i class="fas fa-search search-icon"></i>
            </div>
            
            <div class="login-register">
                <a href="{% url 'login' %}" class="login-btn">Login</a>
                <a href="{% url 'register' %}" class="register-btn">Register Free</a>
            </div>
        </div>
    </header>
    <section class="success-story-section">
        <div class="form-header">
        <h1>Share Your Success Story</h1>
        <p>Inspire others by sharing your beautiful journey of finding love through Connect Matrimony. Your story could be the hope someone needs today.</p>
    </div>
    <div class="form-container">
        <!-- Modified form to use Django's CSRF token and POST method -->
        <form id="successStoryForm" method="POST" enctype="multipart/form-data" action="{% url 'addyourstory_view' %}">
            
            {% csrf_token %}
            
            <div class="form-row">
                <div class="form-group">
                    <label for="bridesName" class="form-label required">Bride's Name</label>
                    <input type="text" id="bridesName" name="brides_name" class="form-input" placeholder="Enter bride's full name" required>
                </div>
                <div class="form-group">
                    <label for="groomsName" class="form-label required">Groom's Name</label>
                    <input type="text" id="groomsName" name="grooms_name" class="form-input" placeholder="Enter groom's full name" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="weddingDate" class="form-label required">Wedding Date</label>
                    <input type="date" id="weddingDate" name="wedding_date" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="phoneNumber" class="form-label required">Contact Number</label>
                    <div class="phone-input-container">
                        <select id="countryCode" name="country_code" class="form-input country-code">
                            <option value="+91">+91 (IN)</option>
                            <option value="+1">+1 (US)</option>
                            <option value="+44">+44 (UK)</option>
                            <option value="+971">+971 (UAE)</option>
                        </select>
                        <input type="tel" id="phoneNumber" name="phone_number" class="form-input phone-number" placeholder="Phone number" required>
                    </div>
                </div>
            </div>

            <div class="form-group full-width">
                <label class="form-label required">Wedding Cover Photo</label>
                <div class="upload-section" id="coverPhotoUpload">
                    <div class="upload-content">
                        <div class="upload-icon">
                            <i class="fas fa-camera-retro"></i>
                        </div>
                        <div class="upload-text">
                            <h4>Upload Your Cover Photo</h4>
                            <p>Drag & drop your favorite wedding photo here or click to browse</p>
                        </div>
                        <button type="button" class="browse-btn">Browse Files</button>
                    </div>
                    <!-- Preview will be inserted here by JavaScript -->
                    <input type="file" id="coverPhoto" name="cover_photo" class="file-input" accept="image/*" required>
                </div>
                <div class="preview-container" id="coverPreview"></div>
            </div>
            
            <div class="form-group full-width">
                <label class="form-label">Additional Wedding Photos (Max 5)</label>
                <div class="upload-section" id="additionalPhotosUpload">
                    <div class="upload-content">
                        <div class="upload-icon">
                            <i class="fas fa-images"></i>
                        </div>
                        <div class="upload-text">
                            <h4>Upload Additional Photos</h4>
                            <p>Drag & drop multiple photos here or click to browse</p>
                            <p class="small">Maximum 5 photos allowed (JPEG, PNG)</p>
                        </div>
                        <button type="button" class="browse-btn">Browse Files</button>
                    </div>
                    <input type="file" id="additionalPhotos" name="additional_photos" class="file-input" accept="image/*" multiple>
                </div>
                <div class="preview-container" id="additionalPhotosPreview"></div>
            </div>

            <div class="form-group full-width">
                <label for="yourStory" class="form-label required">Your Story</label>
                <textarea id="yourStory" name="story" class="story-textarea" placeholder="Tell us your beautiful love story... How you met, your journey, and your experience with Connect Matrimony" required></textarea>
            </div>

            <button type="submit" class="submit-btn">
                <i class="fas fa-paper-plane"></i> Share Your Story
            </button>
        </form>
    </div>
</section>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-container">
                <div class="footer-column">
                    <h3 class="footer-title">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#">Home</a></li>
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">Success Stories</a></li>
                        <li><a href="#">Blog</a></li>
                        <li><a href="#">Contact Us</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-title">Help & Support</h3>
                    <ul class="footer-links">
                        <li><a href="#">FAQ</a></li>
                        <li><a href="#">Safety Tips</a></li>
                        <li><a href="#">Membership</a></li>
                        <li><a href="#">Customer Support</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-title">Legal</h3>
                    <ul class="footer-links">
                        <li><a href="#">Terms of Use</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Refund Policy</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-title">Contact Us</h3>
                    <ul class="footer-links">
                        <li><a href="#"><i class="fas fa-map-marker-alt"></i> Kochi, Kerala</a></li>
                        <li><a href="tel:+911234567890"><i class="fas fa-phone"></i> +91 9234567890</a></li>
                        <li><a href="mailto:info@example.com"><i class="fas fa-envelope"></i> connect@gmail.com</a></li>
                    </ul>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
            
            <div class="copyright">
                &copy; 2025 Connect Matrimony. All Rights Reserved.
            </div>
        </footer>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // ========== DROPDOWN MENU FUNCTIONALITY ==========
                const dropdowns = document.querySelectorAll('.dropdown');
                
                dropdowns.forEach(dropdown => {
                    const link = dropdown.querySelector('a');
                    
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        dropdown.classList.toggle('active');
                        
                        // Close other dropdowns
                        dropdowns.forEach(otherDropdown => {
                            if (otherDropdown !== dropdown) {
                                otherDropdown.classList.remove('active');
                            }
                        });
                    });
                });
                
                // Close dropdowns when clicking outside
                document.addEventListener('click', function(e) {
                    if (!e.target.closest('.dropdown')) {
                        dropdowns.forEach(dropdown => {
                            dropdown.classList.remove('active');
                        });
                    }
                });
                
                // Header scroll effect
                window.addEventListener('scroll', function() {
                    const header = document.querySelector('.header');
                    if (window.scrollY > 50) {
                        header.classList.add('scrolled');
                    } else {
                        header.classList.remove('scrolled');
                    }
                });
        
                // ========== FILE UPLOAD FUNCTIONALITY ==========
                // Cover photo upload
                const coverUpload = document.getElementById('coverPhotoUpload');
                const coverInput = document.getElementById('coverPhoto');
                const coverPreview = document.getElementById('coverPreview');
                
                // Additional photos upload
                const additionalUpload = document.getElementById('additionalPhotosUpload');
                const additionalInput = document.getElementById('additionalPhotos');
                const additionalPreview = document.getElementById('additionalPhotosPreview');
                
                // Browse button functionality
                document.querySelectorAll('.browse-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const uploadSection = this.closest('.upload-section');
                        const fileInput = uploadSection.querySelector('.file-input');
                        fileInput.click();
                    });
                });
                
                // Function to handle file previews
                function handleFiles(files, uploadSection, previewContainer, isSingle) {
                    if (isSingle) {
                        // For single file (cover photo)
                        if (files.length > 0) {
                            const file = files[0];
                            if (!file.type.match('image.*')) {
                                alert('Please upload an image file (JPEG, PNG)');
                                return;
                            }
                            
                            const reader = new FileReader();
                            
                            reader.onload = function(e) {
                                // Add has-preview class to the upload section
                                uploadSection.classList.add('has-preview');
                                
                                // Create preview inside upload section
                                let preview = uploadSection.querySelector('.upload-preview');
                                if (!preview) {
                                    preview = document.createElement('div');
                                    preview.className = 'upload-preview';
                                    uploadSection.appendChild(preview);
                                }
                                
                                preview.innerHTML = `
                                    <img src="${e.target.result}" class="upload-preview-image">
                                    <button type="button" class="upload-change-btn">Change</button>
                                `;
                                
                                // Clear any existing preview below
                                previewContainer.innerHTML = '';
                                
                                // Add event listener to change button
                                preview.querySelector('.upload-change-btn').addEventListener('click', function() {
                                    uploadSection.classList.remove('has-preview');
                                    preview.innerHTML = '';
                                    coverInput.value = ''; // Clear the file input
                                });
                            };
                            
                            reader.readAsDataURL(file);
                        }
                    } else {
                        // For multiple files (additional photos)
                        if (files.length > 0) {
                            // Add has-preview class to the upload section
                            uploadSection.classList.add('has-preview');
                            
                            // Create preview container inside upload section
                            let preview = uploadSection.querySelector('.upload-preview');
                            if (!preview) {
                                preview = document.createElement('div');
                                preview.className = 'upload-preview';
                                uploadSection.appendChild(preview);
                            }
                            
                            // Create grid for thumbnails
                            preview.innerHTML = '<div class="upload-preview-grid" id="additionalThumbnails"></div>';
                            const thumbnailsContainer = preview.querySelector('#additionalThumbnails');
                            
                            // Clear any existing preview below
                            additionalPreview.innerHTML = '';
                            
                            // Process files (limit to 5)
                            const filesToProcess = Array.from(files).slice(0, 5);
                            
                            filesToProcess.forEach((file, index) => {
                                if (!file.type.match('image.*')) return;
                                
                                const reader = new FileReader();
                                
                                reader.onload = function(e) {
                                    const previewItem = document.createElement('div');
                                    previewItem.className = 'upload-preview-item';
                                    
                                    const img = document.createElement('img');
                                    img.className = 'upload-preview-image';
                                    img.src = e.target.result;
                                    
                                    const removeBtn = document.createElement('div');
                                    removeBtn.className = 'upload-remove-btn';
                                    removeBtn.innerHTML = '<i class="fas fa-times"></i>';
                                    removeBtn.addEventListener('click', function() {
                                        // Remove this file from the input
                                        const newFiles = Array.from(additionalInput.files).filter((_, i) => i !== index);
                                        const dataTransfer = new DataTransfer();
                                        newFiles.forEach(file => dataTransfer.items.add(file));
                                        additionalInput.files = dataTransfer.files;
                                        
                                        // Update preview
                                        previewItem.remove();
                                        
                                        // If no files left, remove has-preview class
                                        if (newFiles.length === 0) {
                                            uploadSection.classList.remove('has-preview');
                                        }
                                    });
                                    
                                    previewItem.appendChild(img);
                                    previewItem.appendChild(removeBtn);
                                    thumbnailsContainer.appendChild(previewItem);
                                };
                                
                                reader.readAsDataURL(file);
                            });
                            
                            // Add change button
                            const changeBtn = document.createElement('button');
                            changeBtn.type = 'button';
                            changeBtn.className = 'upload-change-btn';
                            changeBtn.textContent = 'Change';
                            changeBtn.style.marginTop = '10px';
                            changeBtn.addEventListener('click', function() {
                                uploadSection.classList.remove('has-preview');
                                preview.innerHTML = '';
                                additionalInput.value = ''; // Clear the file input
                            });
                            
                            preview.appendChild(changeBtn);
                            
                            // Show count if more than 1 file
                            if (filesToProcess.length > 1) {
                                const countBadge = document.createElement('div');
                                countBadge.className = 'upload-count';
                                countBadge.textContent = `${filesToProcess.length}/5`;
                                preview.querySelector('.upload-preview-grid').appendChild(countBadge);
                            }
                        }
                    }
                }
                
                // Function to set up upload section with drag and drop
                function setupUploadSection(uploadSection, inputElement, previewContainer, isSingle) {
                    // Click to select files
                    inputElement.addEventListener('change', function() {
                        if (this.files.length > 0) {
                            handleFiles(this.files, uploadSection, previewContainer, isSingle);
                        }
                    });
                    
                    // Drag and drop functionality
                    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                        uploadSection.addEventListener(eventName, preventDefaults, false);
                    });
                    
                    function preventDefaults(e) {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                    
                    ['dragenter', 'dragover'].forEach(eventName => {
                        uploadSection.addEventListener(eventName, highlight, false);
                    });
                    
                    ['dragleave', 'drop'].forEach(eventName => {
                        uploadSection.addEventListener(eventName, unhighlight, false);
                    });
                    
                    function highlight() {
                        uploadSection.classList.add('active');
                    }
                    
                    function unhighlight() {
                        uploadSection.classList.remove('active');
                    }
                    
                    uploadSection.addEventListener('drop', function(e) {
                        const dt = e.dataTransfer;
                        const files = dt.files;
                        
                        if (files.length > 0) {
                            if (isSingle) {
                                inputElement.files = files;
                            } else {
                                // For multiple files, create a new DataTransfer object
                                const dataTransfer = new DataTransfer();
                                Array.from(files).slice(0, 5).forEach(file => {
                                    dataTransfer.items.add(file);
                                });
                                inputElement.files = dataTransfer.files;
                            }
                            handleFiles(files, uploadSection, previewContainer, isSingle);
                        }
                    });
                }
                
                // Initialize the upload sections
                setupUploadSection(coverUpload, coverInput, coverPreview, true);
                setupUploadSection(additionalUpload, additionalInput, additionalPreview, false);
                
                // Form submission
                document.getElementById('successStoryForm').addEventListener('submit', function(e) {
                    // Validate required fields
                    if (!coverInput.files || coverInput.files.length === 0) {
                        e.preventDefault();
                        alert('Please upload a cover photo');
                        return;
                    }
                    
                    // Just show a loading state
                    const submitBtn = this.querySelector('.submit-btn');
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
                });
            });
        </script>
    </body>
    </html>